(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     93914,       2518]
NotebookOptionsPosition[     85728,       2383]
NotebookOutlinePosition[     86123,       2400]
CellTagsIndexPosition[     86080,       2397]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Toolkit", "Title",
 CellChangeTimes->{{3.7618767896181726`*^9, 
  3.761876792751928*^9}},ExpressionUUID->"4d2185bc-faaa-4204-ab86-\
f554734b7f71"],

Cell[CellGroupData[{

Cell["Pauli Algebra", "Section",
 CellChangeTimes->{{3.7618556554049654`*^9, 
  3.7618556614647675`*^9}},ExpressionUUID->"59a9c5ca-74cb-4e9b-834c-\
e32382df7efe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Define", " ", "pauli", " ", "string"}], ",", " ", 
    RowBox[{
     RowBox[{"\[Sigma]s", "[", 
      RowBox[{"a", ",", "b", ",", ".."}], "]"}], "=", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[Sigma]", "a"], "\[TensorProduct]", 
       SuperscriptBox["\[Sigma]", "b"], "\[TensorProduct]"}], "..."}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]s", "[", "x_", "]"}], ":=", 
    RowBox[{"PauliMatrix", "[", "x", "]"}]}], "\n", 
   RowBox[{
    RowBox[{"\[Sigma]s", "[", "x__", "]"}], ":=", 
    RowBox[{"KroneckerProduct", "@@", 
     RowBox[{"Map", "[", 
      RowBox[{"PauliMatrix", ",", 
       RowBox[{"{", "x", "}"}]}], "]"}]}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"define", " ", "rotation", " ", "matrix"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[Sigma]Rot", "[", 
     RowBox[{"\[Theta]_", ",", "x__"}], "]"}], ":=", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{"\[ImaginaryI]", " ", "\[Theta]", " ", 
      RowBox[{"\[Sigma]s", "[", "x", "]"}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"\[Sigma]R4", "[", "x__", "]"}], ":=", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{"\[ImaginaryI]", " ", 
      FractionBox["\[Pi]", "4"], " ", 
      RowBox[{"\[Sigma]s", "[", "x", "]"}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"qubit", "[", "m_", "]"}], ":=", 
    RowBox[{"Log", "[", 
     RowBox[{"2", ",", 
      RowBox[{"Length", "[", "m", "]"}]}], "]"}]}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Map", " ", "the", " ", "explicit", " ", "matrix", " ", "to", " ", "a", 
     " ", "symbolic", " ", "one"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"\[Sigma]find", "[", "m_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"qub", ",", "\[Sigma]table", ",", "tup"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"qub", "=", 
        RowBox[{"qubit", "[", "m", "]"}]}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"qub", "\[Element]", "Integers"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tup", "=", 
           RowBox[{"Tuples", "[", 
            RowBox[{
             RowBox[{"Range", "[", 
              RowBox[{"0", ",", "3"}], "]"}], ",", "qub"}], "]"}]}], ";", 
          "\n", 
          RowBox[{"\[Sigma]table", "=", 
           RowBox[{"\[Sigma]s", "@@@", "tup"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Sigma]table", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ArrayReshape", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["2", "qub"], 
                   SuperscriptBox["2", "qub"]}], ",", "1"}], "}"}]}], "]"}], 
              "&"}], "/@", "\[Sigma]table"}], ")"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Total", "[", 
           RowBox[{
            FractionBox["1", 
             SuperscriptBox["2", "qub"]], 
            RowBox[{"Flatten", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Total", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ConjugateTranspose", "@", 
                    RowBox[{"ArrayReshape", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    SuperscriptBox["4", "qub"], ",", "1"}], "}"}]}], "]"}]}], 
                   ".", 
                   RowBox[{
                   "\[Sigma]table", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ")"}], "]"}], 
                RowBox[{"Superscript", "[", 
                 RowBox[{"\[Sigma]", ",", 
                  RowBox[{
                  "tup", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "@", "\[Sigma]table"}]}], "}"}]}], 
              "]"}]}]}], "]"}]}]}], "\n", "]"}]}]}], "\n", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"commute", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", ".", "b"}], "-", 
     RowBox[{"b", ".", "a"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"anticommute", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", ".", "b"}], "+", 
     RowBox[{"b", ".", "a"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]TrueQ", "[", "a_", "]"}], ":=", 
    RowBox[{"TrueQ", "[", 
     RowBox[{
      RowBox[{"Total", "@", 
       RowBox[{"Abs", "@", 
        RowBox[{"Flatten", "[", "a", "]"}]}]}], "<", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"anticommuteQ", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"\[Sigma]TrueQ", "@", 
     RowBox[{"anticommute", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"commuteQ", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
    RowBox[{"\[Sigma]TrueQ", "@", 
     RowBox[{"commute", "[", 
      RowBox[{"a", ",", "b"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Generate", " ", "all", " ", "\[Sigma]", " ", "matrix", " ", "with", " ", 
     "n", " ", "qubit"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]All", "[", "n_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "tup", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tup", "=", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "3"}], "]"}], ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]s", "@@@", "tup"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]select", "[", 
     RowBox[{"funq_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tup", ",", "\[Sigma]table", ",", "n", ",", "fun"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "==", 
        RowBox[{"qubit", "[", "h", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tup", "=", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "3"}], "]"}], ",", "n"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Sigma]table", "=", 
        RowBox[{"\[Sigma]s", "@@@", "tup"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"fun", "=", 
        RowBox[{
         RowBox[{"funq", "[", 
          RowBox[{"h", ",", "#"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Superscript", "[", 
          RowBox[{"\[Sigma]", ",", 
           RowBox[{"tup", "\[LeftDoubleBracket]", 
            RowBox[{
            "i", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Position", "[", 
            RowBox[{
             RowBox[{"fun", "/@", "\[Sigma]table"}], ",", "True"}], "]"}]}], 
          "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}]], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQHaObt06T/Y2jlfy69SD64bEfllpAWirphy2IFjpw
yAdEpzTfjgfR/EJLkkH0lF1PCkH08kj+dhBdZJA/A0Q7nVY9DKKjHWKPgOiD
B+R9tIH0kZINviC6w1u9FESziE4B03rvFatB9Lzcyw0g+hBH6hQQPePMzDkg
umuOkqkZkFary7IA0TmSGfYgmmvKF3cQzeHd7Q+iL+1fGgyiBRZYlYLoI1pc
ZSD6xQnDGhCdcu9EF4iWMWuZCKLtuKSmguigtT4zQbTF4SWzQTRTZOVCEN0X
3A6mL61JcDEH0hP25HqAaD4PyTAQ/dPlB5iWyV6ZCKJ/bFdLAdEAKAqIew==

  "],ExpressionUUID->"1b4ea778-2970-4358-8c7a-8470b43cd4ba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"tup", ",", "\[Sigma]table", ",", "funq", ",", 
     RowBox[{"n", "=", 
      RowBox[{"qubit", "[", "h0", "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tup", "=", 
     RowBox[{"Tuples", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "3"}], "]"}], ",", "n"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Sigma]table", "=", 
     RowBox[{"\[Sigma]s", "@@@", "tup"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"funq", "=", 
     RowBox[{
      RowBox[{"anticommuteQ", "[", 
       RowBox[{"h0", ",", "#"}], "]"}], "&"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Superscript", "[", 
       RowBox[{"\[Sigma]", ",", 
        RowBox[{"tup", "\[LeftDoubleBracket]", 
         RowBox[{"i", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "\[RightDoubleBracket]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"funq", "/@", "\[Sigma]table"}], ",", "True"}], "]"}]}], 
       "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7618783067005157`*^9, 3.7618784085766573`*^9}, {
   3.7618784422543173`*^9, 3.7618784509115734`*^9}, {3.7618786103619623`*^9, 
   3.76187867353823*^9}, 3.761878729701844*^9, {3.7618787608942785`*^9, 
   3.7618787996686764`*^9}, 3.76187989337399*^9, {3.7618800454668784`*^9, 
   3.7618800518549395`*^9}},ExpressionUUID->"80b4dc44-aece-4634-bc1a-\
77332b91ad0e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{"\[Sigma]",RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]},
    "Superscript"], ",", 
   TemplateBox[{"\[Sigma]",RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}]},
    "Superscript"], ",", 
   TemplateBox[{"\[Sigma]",RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]},
    "Superscript"], ",", 
   TemplateBox[{"\[Sigma]",RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]},
    "Superscript"]}], "}"}]], "Output",
 CellChangeTimes->{{3.761878367681964*^9, 3.7618783988429623`*^9}, {
   3.761878616839523*^9, 3.761878629417026*^9}, 3.761878674069809*^9, {
   3.7618787678560658`*^9, 3.7618788000399466`*^9}, 3.7618798939275103`*^9, 
   3.76187993806601*^9, 3.761879970692745*^9, 3.761880052391505*^9, 
   3.7618801216294365`*^9},ExpressionUUID->"655813e4-6ec1-4aa4-837f-\
211b205ba79b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Normal order", "Section",
 CellChangeTimes->{{3.761856474329142*^9, 
  3.7618564767367067`*^9}},ExpressionUUID->"46c92ddd-283e-4af5-9636-\
81cae3bd739d"],

Cell["The basis is, (\[Dagger]\[Rule]d, no \[Dagger]\[Rule]o)", "TextIndent",
 CellChangeTimes->{{3.7618588550611486`*^9, 3.761858859795494*^9}, {
  3.761858971470954*^9, 
  3.7618590242698736`*^9}},ExpressionUUID->"cde0b0b7-e5e6-4188-ae16-\
8effab749546"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"L"},
       {"R"}
      }], "\[NoBreak]", ")"}], "\[TensorProduct]", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"\[UpArrow]"},
       {"\[DownArrow]"}
      }], "\[NoBreak]", ")"}]}], "=", 
   RowBox[{
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"l"},
       {"r"}
      }], "\[NoBreak]", ")"}], "\[TensorProduct]", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"s"},
       {"x"}
      }], "\[NoBreak]", ")"}]}]}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7618588489365196`*^9, 
  3.761858908457629*^9}},ExpressionUUID->"d2d0e69f-576b-4840-97bc-\
04829065b1f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"from", " ", "non"}], "-", "commutative"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", 
    RowBox[{
    "send", ",", "term", ",", "ExpandNCM", ",", "takeDag", ",", "NOrder", ",",
      "NorOrder"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"l", ",", "s", ",", "o"}], "]"}], ",", 
       RowBox[{"a", "[", 
        RowBox[{"l", ",", "x", ",", "o"}], "]"}], ",", 
       RowBox[{"a", "[", 
        RowBox[{"r", ",", "s", ",", "o"}], "]"}], ",", 
       RowBox[{"a", "[", 
        RowBox[{"r", ",", "x", ",", "o"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pd", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"l", ",", "s", ",", "d"}], "]"}], ",", 
       RowBox[{"a", "[", 
        RowBox[{"l", ",", "x", ",", "d"}], "]"}], ",", 
       RowBox[{"a", "[", 
        RowBox[{"r", ",", "s", ",", "d"}], "]"}], ",", 
       RowBox[{"a", "[", 
        RowBox[{"r", ",", "x", ",", "d"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pl", "=", 
     RowBox[{"p", "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pr", "=", 
     RowBox[{"p", "\[LeftDoubleBracket]", 
      RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pld", "=", 
     RowBox[{"pd", "\[LeftDoubleBracket]", 
      RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prd", "=", 
     RowBox[{"pd", "\[LeftDoubleBracket]", 
      RowBox[{"3", ";;", "4"}], "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"l_", ",", "v_", ",", "r_"}], "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"exp", ",", "term1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
         RowBox[{
          RowBox[{"l", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
           "**", 
          RowBox[{
          "r", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "v"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "@", "v"}]}], "}"}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"send", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"h", ":", "Times"}], ")"}], "[", 
      RowBox[{"a___", ",", "b_NonCommutativeMultiply"}], "]"}], "]"}], ":=", 
    RowBox[{"a", " ", 
     RowBox[{"f", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"send", "[", "b_NonCommutativeMultiply", "]"}], ":=", 
    RowBox[{"f", "[", "b", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sendconj", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"h", ":", "Times"}], ")"}], "[", 
      RowBox[{"a___", ",", "b_NonCommutativeMultiply"}], "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Conjugate", "[", "a", "]"}], " ", 
     RowBox[{"f", "[", "b", "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sendconj", "[", "b_NonCommutativeMultiply", "]"}], ":=", 
    RowBox[{"f", "[", "b", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpandNCM", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"h", ":", "NonCommutativeMultiply"}], ")"}], "[", 
      RowBox[{"a___", ",", "b_Plus", ",", "c___"}], "]"}], "]"}], ":=", 
    RowBox[{"Distribute", "[", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"a", ",", "b", ",", "c"}], "]"}], ",", "Plus", ",", "h", ",", 
      "Plus", ",", 
      RowBox[{
       RowBox[{"ExpandNCM", "[", 
        RowBox[{"h", "[", "##", "]"}], "]"}], "&"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpandNCM", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"h", ":", "NonCommutativeMultiply"}], ")"}], "[", 
      RowBox[{"a___", ",", "b_Times", ",", "c___"}], "]"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Most", "[", "b", "]"}], 
     RowBox[{"ExpandNCM", "[", 
      RowBox[{"h", "[", 
       RowBox[{"a", ",", 
        RowBox[{"Last", "[", "b", "]"}], ",", "c"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ExpandNCM", "[", "a_", "]"}], ":=", 
    RowBox[{"ExpandAll", "[", "a", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"takeDag", "[", "exp_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "ex", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ex", "=", 
        RowBox[{"Distribute", "[", 
         RowBox[{"sendconj", "[", 
          RowBox[{"ExpandNCM", "[", "exp", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ex", "=", 
        RowBox[{"ex", "/.", 
         RowBox[{"f", "\[Rule]", "Reverse"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ex", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"o", "\[Rule]", "d"}], ",", 
          RowBox[{"d", "\[Rule]", "o"}]}], "}"}]}]}]}], "\[IndentingNewLine]",
      "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NOrder", "[", "0", "]"}], "=", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"NOrder", "[", 
       RowBox[{"left___", ",", 
        RowBox[{"a_", "[", "k1__", "]"}], ",", 
        RowBox[{"b_", "[", "k2__", "]"}], ",", "right___"}], "]"}], "/;", 
      RowBox[{"!", 
       RowBox[{"OrderedQ", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "k1", "}"}], ",", 
          RowBox[{"{", "k2", "}"}]}], "}"}], "]"}]}]}], ":=", 
     RowBox[{"-", 
      RowBox[{"NOrder", "[", 
       RowBox[{"left", ",", 
        RowBox[{"b", "[", "k2", "]"}], ",", 
        RowBox[{"a", "[", "k1", "]"}], ",", "right"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NorOrder", "[", "exp_", "]"}], ":=", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", "ex", "}"}], ",", 
      RowBox[{
       RowBox[{"ex", "=", 
        RowBox[{"Distribute", "[", 
         RowBox[{"send", "[", 
          RowBox[{"ExpandNCM", "[", "exp", "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ex", "=", 
        RowBox[{"ex", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NonCommutativeMultiply", "[", "ss__", "]"}], 
           "\[RuleDelayed]", " ", "ss"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ex", "/.", 
        RowBox[{"f", "\[Rule]", "NOrder"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.7618586634586754`*^9, 3.761858686231804*^9}, 
   3.761858835794647*^9, {3.761858919403372*^9, 3.761858968704349*^9}, {
   3.7618590301920433`*^9, 3.761859260200717*^9}, {3.761859635446613*^9, 
   3.7618596453687983`*^9}, {3.7618596790737677`*^9, 
   3.7618598292453575`*^9}, {3.7618599249988165`*^9, 3.761859926285188*^9}, {
   3.7618599582687855`*^9, 3.761859959692979*^9}, {3.761860034981736*^9, 
   3.7618600913010035`*^9}, {3.7618601497294736`*^9, 
   3.7618601769134254`*^9}, {3.7618602545970707`*^9, 
   3.7618602888525085`*^9}, {3.761862382284545*^9, 3.7618623826296225`*^9}, {
   3.7618625133338604`*^9, 3.7618625136799345`*^9}, {3.7618659884507527`*^9, 
   3.761865990326033*^9}, {3.7618681413001995`*^9, 3.7618681576301107`*^9}, {
   3.762022343648427*^9, 3.7620223505161085`*^9}, {3.7620256597885094`*^9, 
   3.7620256963457947`*^9}, {3.7620257929007144`*^9, 
   3.7620257990323544`*^9}, {3.762025835601576*^9, 3.7620259185009947`*^9}, 
   3.762025987483639*^9, {3.762026065580861*^9, 3.762026086294532*^9}, {
   3.762026286027627*^9, 3.7620262894325247`*^9}, {3.7620264483608427`*^9, 
   3.762026470628291*^9}, {3.7620265063448257`*^9, 3.762026528808811*^9}, {
   3.7620266686360345`*^9, 3.7620267370162954`*^9}, {3.7620269017519355`*^9, 
   3.7620269147152853`*^9}, {3.762026946853385*^9, 3.7620269661398335`*^9}, {
   3.762027073038138*^9, 
   3.762027114016572*^9}},ExpressionUUID->"2867befe-40c7-4f90-ad3e-\
00619658b556"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rules", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"l", ",", "s", ",", "d"}], "]"}], "\[Rule]", 
       "\"\<\!\(\*SubsuperscriptBox[\(\[Psi]\), \(\(L\)\(\[UpArrow]\)\), \(\
\[Dagger]\)]\)\>\""}], ",", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"l", ",", "s", ",", "o"}], "]"}], "\[Rule]", 
       "\"\<\!\(\*SubscriptBox[\(\[Psi]\), \(\(L\)\(\[UpArrow]\)\)]\)\>\""}], 
      ",", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"l", ",", "x", ",", "d"}], "]"}], "\[Rule]", 
       "\"\<\!\(\*SubsuperscriptBox[\(\[Psi]\), \(\(L\)\(\[DownArrow]\)\), \(\
\[Dagger]\)]\)\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"l", ",", "x", ",", "o"}], "]"}], "\[Rule]", 
       "\"\<\!\(\*SubscriptBox[\(\[Psi]\), \
\(\(L\)\(\[DownArrow]\)\)]\)\>\""}], ",", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"r", ",", "s", ",", "d"}], "]"}], "\[Rule]", 
       "\"\<\!\(\*SubsuperscriptBox[\(\[Psi]\), \(\(R\)\(\[UpArrow]\)\), \(\
\[Dagger]\)]\)\>\""}], ",", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"r", ",", "s", ",", "o"}], "]"}], "\[Rule]", 
       "\"\<\!\(\*SubscriptBox[\(\[Psi]\), \(\(R\)\(\[UpArrow]\)\)]\)\>\""}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"r", ",", "x", ",", "d"}], "]"}], "\[Rule]", 
       "\"\<\!\(\*SubsuperscriptBox[\(\[Psi]\), \(\(R\)\(\[DownArrow]\)\), \(\
\[Dagger]\)]\)\>\""}], ",", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"r", ",", "x", ",", "o"}], "]"}], "\[Rule]", 
       "\"\<\!\(\*SubscriptBox[\(\[Psi]\), \
\(\(R\)\(\[DownArrow]\)\)]\)\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", "d", "]"}], "\[Rule]", 
       "\"\<\!\(\*SuperscriptBox[\(\[Psi]\), \(\[Dagger]\)]\)\>\""}], ",", 
      RowBox[{
       RowBox[{"a", "[", "o", "]"}], "\[Rule]", "\"\<\[Psi]\>\""}]}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"represent", "[", "exp_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"exp", "/.", 
     RowBox[{
      RowBox[{"NOrder", "[", "a__", "]"}], "\[RuleDelayed]", 
      RowBox[{"NO", "[", "a", "]"}]}]}], ")"}], "/.", "rules"}]}]}], "Code",
 CellChangeTimes->{{3.761857174598297*^9, 3.7618571899492645`*^9}, {
   3.761857261897973*^9, 3.7618573211665277`*^9}, {3.7618573948824897`*^9, 
   3.7618574545509996`*^9}, {3.7618575455374746`*^9, 
   3.7618575733032584`*^9}, {3.761857691755642*^9, 3.7618577103698874`*^9}, {
   3.7618580395389223`*^9, 3.7618580477868757`*^9}, {3.7618580861104393`*^9, 
   3.7618580889907403`*^9}, {3.7618581628720007`*^9, 3.761858273447439*^9}, {
   3.7618584543675632`*^9, 3.761858528082528*^9}, {3.761858560816033*^9, 
   3.7618585615151887`*^9}, {3.76185865003356*^9, 3.761858652347375*^9}, {
   3.7618596524867725`*^9, 3.76185966384647*^9}, {3.761859855645791*^9, 
   3.7618598584572754`*^9}, {3.761859939388245*^9, 3.761859939833056*^9}, {
   3.76186456693322*^9, 3.761864573974067*^9}, {3.7618649263192453`*^9, 
   3.761864933088152*^9}, {3.761865217238413*^9, 3.761865225938159*^9}, 
   3.7618654101503925`*^9, {3.7618654898707685`*^9, 3.7618655308856564`*^9}, {
   3.7618657424107428`*^9, 3.7618657772615027`*^9}, {3.761865826219511*^9, 
   3.761865893801347*^9}, {3.761866745911904*^9, 3.761866763100587*^9}, {
   3.7619598220730124`*^9, 3.7619598665120373`*^9}, {3.7619644415484076`*^9, 
   3.761964443599924*^9}, {3.76196451222792*^9, 3.761964540890933*^9}, {
   3.762026400442891*^9, 3.7620264030748644`*^9}, {3.7620270668057604`*^9, 
   3.7620270673643074`*^9}},ExpressionUUID->"b7847fdc-37a9-4f8c-940b-\
0be2d0ff53ca"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Chi]tof", "[", "x_", "]"}], ":=", 
  RowBox[{"NorOrder", "@", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "ff"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ff", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "[", "o", "]"}], ",", 
         RowBox[{"a", "[", "d", "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{
        FractionBox["1", "2"], 
        RowBox[{
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", 
             RowBox[{"-", "\[ImaginaryI]"}]},
            {"1", "\[ImaginaryI]"}
           }], "\[NoBreak]", ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"\[Sigma]s", "[", "x", "]"}], ")"}], ".", 
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "1"},
            {
             RowBox[{"-", "\[ImaginaryI]"}], "\[ImaginaryI]"}
           }], "\[NoBreak]", ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
         RowBox[{
          RowBox[{
          "ff", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "**", 
          RowBox[{
          "ff", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "@", "v"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "@", "v"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"\[Chi]tof", "[", "x", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "3"}], "}"}]}], "]"}], "//", 
  "represent"}]}], "Code",
 CellChangeTimes->{{3.76195939983034*^9, 3.761959445511732*^9}, {
  3.761959481357019*^9, 3.7619594852855177`*^9}, {3.7619595536487894`*^9, 
  3.7619596293047314`*^9}, {3.7619596814323974`*^9, 3.7619598126382313`*^9}, {
  3.7619598708486004`*^9, 
  3.76195987244234*^9}},ExpressionUUID->"5d326349-2b13-4deb-aabe-\
052414fa5bc0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"NO", "[", 
      RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(\[Psi]\\), \
\\(\[Dagger]\\)]\\)\"\>", 
       ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Psi]\\), \
\\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
    RowBox[{"\[ImaginaryI]", " ", 
     RowBox[{"NO", "[", 
      RowBox[{"\<\"\[Psi]\"\>", ",", "\<\"\[Psi]\"\>"}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    RowBox[{"NO", "[", 
     RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(\[Psi]\\), \\(\[Dagger]\\)]\\)\"\
\>", ",", "\<\"\[Psi]\"\>"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"NO", "[", 
     RowBox[{"\<\"\\!\\(\\*SuperscriptBox[\\(\[Psi]\\), \\(\[Dagger]\\)]\\)\"\
\>", ",", "\<\"\\!\\(\\*SuperscriptBox[\\(\[Psi]\\), \
\\(\[Dagger]\\)]\\)\"\>"}], "]"}], "+", 
    RowBox[{"NO", "[", 
     RowBox[{"\<\"\[Psi]\"\>", ",", "\<\"\[Psi]\"\>"}], "]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7619597928007097`*^9, 3.76195980392552*^9}, {
   3.761959868391162*^9, 3.761959872841302*^9}, 3.7620040815831456`*^9, 
   3.7620256995891275`*^9, 3.762026080279574*^9, 3.762026346871997*^9, 
   3.7620264093141785`*^9, {3.7620264825035496`*^9, 3.762026488565377*^9}, 
   3.762026599521772*^9, 3.7620267392473636`*^9, 3.7620271335164804`*^9, 
   3.7620274202579575`*^9, 3.7620437024296007`*^9, 3.7620905266808066`*^9, 
   3.7621093268351912`*^9, 
   3.762261297621482*^9},ExpressionUUID->"485ed483-2f06-4aa7-be77-\
7fee3f5e7c87"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Eamples", "Subsection",
 CellChangeTimes->{{3.76195937622344*^9, 
  3.7619593781951694`*^9}},ExpressionUUID->"f7b2c999-e38d-4596-b6f1-\
507f4a34f6db"],

Cell[CellGroupData[{

Cell["JJ current", "Subsubsubsection",
 CellChangeTimes->{{3.761869203071538*^9, 
  3.7618692045436416`*^9}},ExpressionUUID->"766cdfd1-1750-49b6-b14e-\
868c2e7c9ec0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Psi]", "L"], 
       SuperscriptBox["\[ImaginaryI]\[Sigma]", "y"], 
       SubscriptBox["\[Psi]", "L"]}], ")"}], "\[Dagger]"], 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["\[Psi]", "R"], 
      SuperscriptBox["\[ImaginaryI]\[Sigma]", "y"], 
      SubscriptBox["\[Psi]", "R"]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NorOrder", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"takeDag", "@", 
       RowBox[{"term", "[", 
        RowBox[{"pl", ",", 
         RowBox[{"\[ImaginaryI]", " ", 
          RowBox[{"\[Sigma]s", "[", "2", "]"}]}], ",", "pl"}], "]"}]}], ")"}],
      "**", 
     RowBox[{"term", "[", 
      RowBox[{"pr", ",", 
       RowBox[{"\[ImaginaryI]", " ", 
        RowBox[{"\[Sigma]s", "[", "2", "]"}]}], ",", "pr"}], "]"}]}], "]"}], "//",
    "represent"}]}]], "Input",
 CellChangeTimes->{{3.7618655360109577`*^9, 3.7618655401969175`*^9}, {
  3.7618655749969416`*^9, 3.761865583206571*^9}, {3.7618656697126255`*^9, 
  3.761865708659752*^9}, {3.761865787029394*^9, 3.7618658022554283`*^9}, {
  3.7618659296875315`*^9, 3.7618659317400455`*^9}},
 CellLabel->
  "In[851]:=",ExpressionUUID->"082d7c02-9288-4386-98b4-c0c275c98747"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}]], "Output",
 CellChangeTimes->{3.76186554070456*^9, 3.761865802814933*^9, 
  3.761865932196605*^9},
 CellLabel->
  "Out[851]=",ExpressionUUID->"52d131a9-2bea-432e-97ae-b81403c8f4b7"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      SubscriptBox["U", "\[PlusMinus]"], "2"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["\[Psi]", "L", "T"], "\[ImaginaryI]", " ", 
        SuperscriptBox["\[Sigma]", "y"], 
        SubscriptBox["\[Psi]", "L"]}], ")"}], "\[Dagger]"], 
     RowBox[{"(", 
      RowBox[{
       SubsuperscriptBox["\[Psi]", "R", "T"], "\[ImaginaryI]", " ", 
       SuperscriptBox["\[Sigma]", "y"], 
       SubscriptBox["\[Psi]", "R"]}], ")"}]}], "+", 
    RowBox[{"h", ".", "c", "."}]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], 
     FractionBox[
      SubscriptBox["U", "\[PlusMinus]"], "2"], 
     FractionBox["1", 
      RowBox[{"4", 
       SuperscriptBox["\[Pi]", "2"]}]], 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         SubscriptBox["l", "0"], "\[Phi]"}]], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"+", "\[ImaginaryI]"}], " ", 
         SubscriptBox["l", "0"], "\[Phi]"}]]}], ")"}]}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SubscriptBox["U", "\[PlusMinus]"], 
       SuperscriptBox["\[Pi]", "2"]]}], "cos", " ", 
     SubscriptBox["l", "0"], "\[Phi]"}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761869212848443*^9, 
  3.7618693421564555`*^9}},ExpressionUUID->"10b658e6-8942-4075-a342-\
d573db4deb03"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], 
    SubscriptBox["\[Psi]", "L"], 
    SubsuperscriptBox["\[Psi]", "R", "\[Dagger]"], 
    SubscriptBox["\[Psi]", "R"]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NorOrder", "[", 
    RowBox[{
     RowBox[{"term", "[", 
      RowBox[{"pld", ",", 
       RowBox[{"\[Sigma]s", "[", "0", "]"}], ",", "pl"}], "]"}], "**", 
     RowBox[{"term", "[", 
      RowBox[{"prd", ",", 
       RowBox[{"\[Sigma]s", "[", "0", "]"}], ",", "pr"}], "]"}]}], "]"}], "//",
    "represent"}]}]], "Input",
 CellChangeTimes->{{3.761865958697798*^9, 3.7618660718170385`*^9}},
 CellLabel->
  "In[867]:=",ExpressionUUID->"28024de2-17ac-4660-a24e-f59def51137a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.76186597199771*^9, 3.761866027394247*^9}, 
   3.761866072598948*^9},
 CellLabel->
  "Out[867]=",ExpressionUUID->"cf9ee032-7239-4409-ae39-8cfdb101d20b"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["U", "3"], 
   FractionBox["1", 
    RowBox[{"4", 
     SuperscriptBox["\[Pi]", "2"]}]], 
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"L", "\[UpArrow]"}]]}], "+", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"L", "\[DownArrow]"}]]}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[UpArrow]"}]]}], "+", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[DownArrow]"}]]}]}], ")"}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7618694156239758`*^9, 
  3.7618694478523273`*^9}},ExpressionUUID->"4d5fd6d2-fa74-4da9-a7c6-\
ece547539361"]
}, Open  ]],

Cell[CellGroupData[{

Cell["vertex operators", "Subsubsubsection",
 CellChangeTimes->{{3.761867199305853*^9, 
  3.7618672026120167`*^9}},ExpressionUUID->"dd84b482-818d-4fd1-ae34-\
46286e00263f"],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubsuperscriptBox["S", "0", "x"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], 
      SuperscriptBox["\[Sigma]", "x"], 
      SubscriptBox["\[Psi]", "R"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Psi]", "R", "\[Dagger]"], 
      SuperscriptBox["\[Sigma]", "x"], 
      SubscriptBox["\[Psi]", "L"]}]}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "0"}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{"1", ",", "0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"-", "1"}], ",", "0"}], ")"}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761866281534309*^9, 3.7618663115096817`*^9}, {
  3.7618663662949963`*^9, 3.76186641799818*^9}, {3.761867000098685*^9, 
  3.761867000962376*^9}},ExpressionUUID->"f90de84e-9d80-41e6-b830-\
056493b347c3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", 
      RowBox[{"\[Sigma]s", "[", "1", "]"}], ",", "pr"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"\[Sigma]s", "[", "1", "]"}], ",", "pl"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.7618663159761*^9, 3.7618663551579657`*^9}, 
   3.761866617809458*^9},
 CellLabel->
  "In[872]:=",ExpressionUUID->"e727843b-882e-4367-b5f4-b254a65d2e1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.7618663487680454`*^9, 3.761866355571859*^9}},
 CellLabel->
  "Out[872]=",ExpressionUUID->"6df2614e-61c9-4df6-95b6-3684ca368e11"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubsuperscriptBox["S", "\[Pi]", "y"], "=", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "1"}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0", ",", 
        RowBox[{"-", "1"}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", 
        RowBox[{"-", "1"}], ",", "0"}], ")"}]}], ")"}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761866991942486*^9, 3.7618669967137327`*^9}, {
  3.761867034634038*^9, 
  3.761867066762748*^9}},ExpressionUUID->"de7ac2b3-9e79-4dc6-b5b2-\
6e5b5e37aba3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", 
      RowBox[{"\[Sigma]s", "[", "2", "]"}], ",", "pr"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"\[Sigma]s", "[", "2", "]"}], ",", "pl"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.7618670223096294`*^9, 3.7618670237361*^9}},
 CellLabel->
  "In[884]:=",ExpressionUUID->"79d4c2b8-21a4-4dc1-a4d9-539991c89347"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\[UpArrow]\\)\
\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.7618670320518723`*^9},
 CellLabel->
  "Out[884]=",ExpressionUUID->"02e93752-b837-43ed-8ac3-41d1f98bfb94"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubsuperscriptBox["S", "0", "z"], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"0", ",", "1", ",", "0", ",", 
      RowBox[{"-", "1"}]}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{"1", ",", "0", ",", 
      RowBox[{"-", "1"}], ",", "0"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{"0", ",", 
      RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "0"}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "0"}], ")"}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761866603989398*^9, 
  3.761866678745921*^9}},ExpressionUUID->"1caafca3-3acd-46a1-86a5-\
63b96daa8c47"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", 
      RowBox[{"\[Sigma]s", "[", "3", "]"}], ",", "pr"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"\[Sigma]s", "[", "3", "]"}], ",", "pl"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.761866621676122*^9, 3.7618666253737803`*^9}},
 CellLabel->
  "In[874]:=",ExpressionUUID->"65a45a98-6343-469a-acda-b28bb119aa95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\[DownArrow]\
\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}], "-", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}], "-", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}]}]], "Output",
 CellChangeTimes->{3.761866626236474*^9},
 CellLabel->
  "Out[874]=",ExpressionUUID->"0d4c96fd-6797-4c92-8627-a77df8701a74"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["D", "\[Pi]"], "=", 
   RowBox[{
    RowBox[{"-", "\[ImaginaryI]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0", ",", 
        RowBox[{"-", "1"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "0"}], ")"}]}], 
     ")"}]}]}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7618666839458904`*^9, 3.7618666855735397`*^9}, {
  3.761866770837906*^9, 
  3.761866827994003*^9}},ExpressionUUID->"dfa61277-3e9d-4a03-8053-\
22e2ed71d693"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"\[Sigma]s", "[", "0", "]"}]}], ",", "pr"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"\[Sigma]s", "[", "0", "]"}]}], ",", "pl"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.761866706315132*^9, 3.761866727324082*^9}},
 CellLabel->
  "In[882]:=",ExpressionUUID->"5e6f7d2c-72ff-4138-a76e-cb1f9f1b485a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[ImaginaryI]"}], " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\[UpArrow]\\)\
\\)]\\)\"\>"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.7618667280940266`*^9, 3.7618667670749636`*^9},
 CellLabel->
  "Out[882]=",ExpressionUUID->"6544af89-692a-4522-b747-aab8bbe55930"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[CapitalGamma]", "0"], "-", 
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"0", ",", "1", ",", "0", ",", 
         RowBox[{"-", "1"}]}], ")"}]}], "+", 
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "1"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "1", ",", "0"}], ")"}]}], 
     ")"}]}]}], TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7618668800398865`*^9, 3.7618668850494957`*^9}, {
  3.7618669518833666`*^9, 
  3.7618669710144253`*^9}},ExpressionUUID->"db0542c7-9621-49ac-b33e-\
2325e757393f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       RowBox[{"\[Sigma]s", "[", "3", "]"}]}], ",", "pr"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"\[ImaginaryI]", " ", 
       RowBox[{"\[Sigma]s", "[", "3", "]"}]}], ",", "pl"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.761866935494646*^9, 3.761866944786336*^9}},
 CellLabel->
  "In[883]:=",ExpressionUUID->"00e0888a-6a18-4bb7-be09-b08ce81efaad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "+", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\[UpArrow]\\)\
\\)]\\)\"\>"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.761866945849494*^9},
 CellLabel->
  "Out[883]=",ExpressionUUID->"e13375e7-cc43-4f31-afe8-39a49e4b285c"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubsuperscriptBox["S", "\[Pi]", "x"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], 
      SuperscriptBox["\[Sigma]", "x"], 
      SubscriptBox["\[Psi]", "L"]}], "+", 
     RowBox[{
      SubsuperscriptBox["\[Psi]", "R", "\[Dagger]"], 
      SuperscriptBox["\[Sigma]", "x"], 
      SubscriptBox["\[Psi]", "R"]}]}], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "1"}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{"0", ",", "0", ",", "1", ",", 
       RowBox[{"-", "1"}]}], ")"}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761866281534309*^9, 3.7618663115096817`*^9}, {
  3.7618663662949963`*^9, 3.76186641799818*^9}, {3.76186645622255*^9, 
  3.7618665096059923`*^9}, {3.761867078603099*^9, 
  3.761867079397974*^9}},ExpressionUUID->"90413384-7121-48a5-872e-\
d1fa6fb55a80"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", 
      RowBox[{"\[Sigma]s", "[", "1", "]"}], ",", "pl"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"\[Sigma]s", "[", "1", "]"}], ",", "pr"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.7618663159761*^9, 3.7618663551579657`*^9}, {
  3.761866466694559*^9, 3.761866469794037*^9}},
 CellLabel->
  "In[873]:=",ExpressionUUID->"fbdd5d03-ff3f-4a27-89e3-b4eb59c7580c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.7618663487680454`*^9, 3.761866355571859*^9}, 
   3.761866470512144*^9},
 CellLabel->
  "Out[873]=",ExpressionUUID->"1c754807-7696-4853-be6d-f42387bfca41"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubsuperscriptBox["S", "0", "y"], "=", 
   RowBox[{"-", 
    RowBox[{"\[ImaginaryI]", "(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1", ",", "0", ",", "0"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "1"}], ",", "1"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}], ",", "0", ",", "0"}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1", ",", 
        RowBox[{"-", "1"}]}], ")"}]}], ")"}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761867097095712*^9, 
  3.7618671603906727`*^9}},ExpressionUUID->"f93de74d-c607-4035-8bd8-\
26ca2cff0f36"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", 
      RowBox[{"\[Sigma]s", "[", "2", "]"}], ",", "pl"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"\[Sigma]s", "[", "2", "]"}], ",", "pr"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.7618671196793475`*^9, 3.761867121198287*^9}},
 CellLabel->
  "In[885]:=",ExpressionUUID->"e1bb0dde-f973-4f6d-a385-e423efd1192b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "\[ImaginaryI]"}], " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"\[ImaginaryI]", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.7618671220948906`*^9},
 CellLabel->
  "Out[885]=",ExpressionUUID->"f99087c6-2820-4b05-b89c-0566b3eaae20"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["current operators", "Subsubsubsection",
 CellChangeTimes->{{3.7618672075697637`*^9, 
  3.7618672109557133`*^9}},ExpressionUUID->"1eed4127-8784-41cf-a73f-\
08d9369cf262"],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubsuperscriptBox["S", "\[Pi]", "z"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[DownArrow]"}]]}]}], "+", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"L", "\[UpArrow]"}]]}], "+", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[DownArrow]"}]]}], "-", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[UpArrow]"}]]}]}], "=", 
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[UpArrow]"}]], "-", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[DownArrow]"}]], "-", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"R", "\[UpArrow]"}]], "+", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"R", "\[DownArrow]"}]]}], ")"}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7618672160660534`*^9, 3.761867227596821*^9}, {
  3.761867258870742*^9, 
  3.761867378812183*^9}},ExpressionUUID->"9b808fe1-63a1-4d92-bf8c-\
ba3867f34879"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", 
      RowBox[{"\[Sigma]s", "[", "3", "]"}], ",", "pl"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"\[Sigma]s", "[", "3", "]"}], ",", "pr"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.76186725316998*^9, 3.7618672551955657`*^9}},
 CellLabel->
  "In[886]:=",ExpressionUUID->"9543ae62-868e-4037-b153-ca727f653424"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}], "-", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}]}]], "Output",
 CellChangeTimes->{3.761867255622424*^9},
 CellLabel->
  "Out[886]=",ExpressionUUID->"606ce1d1-4ac9-4eb3-bb77-7ac116f46bb8"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["\[CapitalGamma]", "\[Pi]"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[DownArrow]"}]]}]}], "+", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"L", "\[UpArrow]"}]]}], "-", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[DownArrow]"}]]}], "+", 
     RowBox[{
      SubscriptBox["\[PartialD]", "x"], 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[UpArrow]"}]]}]}], "=", 
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[UpArrow]"}]], "-", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[DownArrow]"}]], "+", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"R", "\[UpArrow]"}]], "-", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"R", "\[DownArrow]"}]]}], ")"}]}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7618673875181503`*^9, 3.7618673915258007`*^9}, {
  3.7618674710387783`*^9, 
  3.761867513342383*^9}},ExpressionUUID->"96cefbdc-9d04-4d42-8bfb-\
844f5250b31b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", " ", 
      RowBox[{"\[Sigma]s", "[", "3", "]"}], ",", "pl"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"-", " ", 
       RowBox[{"\[Sigma]s", "[", "3", "]"}]}], ",", "pr"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.7618674190265636`*^9, 3.761867468392851*^9}},
 CellLabel->
  "In[888]:=",ExpressionUUID->"b64f2689-eb34-4f32-8697-5e701ac5792c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}], "-", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.7618674454460397`*^9, 3.7618674688645897`*^9}},
 CellLabel->
  "Out[888]=",ExpressionUUID->"c2dab323-69d5-4a86-8440-9a443a1f8dad"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["D", "0"], "=", 
   RowBox[{
    SubscriptBox["\[PartialD]", "x"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[UpArrow]"}]]}], "-", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"L", "\[DownArrow]"}]], "-", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[UpArrow]"}]], "-", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[DownArrow]"}]]}], ")"}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761867393880271*^9, 3.7618673947100534`*^9}, {
  3.761867556350898*^9, 
  3.761867570614416*^9}},ExpressionUUID->"25a7dfd0-3f18-487a-8819-\
c5de02088ccb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"NorOrder", "[", 
   RowBox[{
    RowBox[{"term", "[", 
     RowBox[{"pld", ",", " ", 
      RowBox[{"-", 
       RowBox[{"\[Sigma]s", "[", "0", "]"}]}], ",", "pl"}], "]"}], "+", 
    RowBox[{"term", "[", 
     RowBox[{"prd", ",", 
      RowBox[{"\[Sigma]s", "[", "0", "]"}], ",", "pr"}], "]"}]}], "]"}], "//",
   "represent"}]], "Input",
 CellChangeTimes->{{3.76186754179134*^9, 3.761867552195076*^9}},
 CellLabel->
  "In[889]:=",ExpressionUUID->"0f5339a0-1e94-42a0-a02f-23e08e25816c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}], "+", 
  RowBox[{"NO", "[", 
   RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
    ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[UpArrow]\\)\\)]\\)\"\>"}], "]"}]}]], "Output",
 CellChangeTimes->{3.7618675532096815`*^9},
 CellLabel->
  "Out[889]=",ExpressionUUID->"fc8a7861-dded-4e69-85bc-9e7ffeefc2be"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["perturbation", "Subsubsubsection",
 CellChangeTimes->{{3.761867607427184*^9, 
  3.7618676096183276`*^9}},ExpressionUUID->"ce3f171e-65bf-4ea0-9fa2-\
d01179210bf5"],

Cell[BoxData[{
 FormBox[
  RowBox[{
   SubsuperscriptBox["n", "1", "2"], "-", 
   SubsuperscriptBox["n", "2", "2"]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], 
        SuperscriptBox["\[Sigma]", "x"], 
        SubscriptBox["\[Psi]", "R"]}], ")"}], "\[Dagger]"], 
     SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], 
     SuperscriptBox["\[Sigma]", "x"], 
     SubscriptBox["\[Psi]", "R"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], 
        SuperscriptBox["\[Sigma]", "y"], 
        SubscriptBox["\[Psi]", "R"]}], ")"}], "\[Dagger]"], 
     SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], 
     SuperscriptBox["\[Sigma]", "y"], 
     SubscriptBox["\[Psi]", "R"]}]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], 
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["l", "12"], "\[Phi]"}]]}], "-", 
    RowBox[{"2", 
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SubscriptBox["l", "12"], "\[Phi]"}]]}]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["4", 
       RowBox[{"4", 
        SuperscriptBox["\[Pi]", "2"]}]]}], "cos", " ", 
     SubscriptBox["l", "12"], "\[Phi]"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["\[Pi]", "2"]]}], "cos", " ", 
     SubscriptBox["l", "12"], "\[Phi]"}]}]}], 
  TraditionalForm]}], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761867650463035*^9, 3.7618677446467037`*^9}, {
  3.7618679896353188`*^9, 3.761868049757018*^9}, {3.7618681703490562`*^9, 
  3.761868189519899*^9}, {3.7618682925355434`*^9, 3.761868312580897*^9}, {
  3.761868403454061*^9, 3.76186847031344*^9}, {3.7618687087528257`*^9, 
  3.761868717297423*^9}},ExpressionUUID->"7a295646-e2c1-40e4-b5de-\
a45828725932"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"NorOrder", "[", 
     RowBox[{
      RowBox[{"takeDag", "[", 
       RowBox[{"term", "[", 
        RowBox[{"pld", ",", 
         RowBox[{"\[Sigma]s", "[", "1", "]"}], ",", "pr"}], "]"}], "]"}], "**", 
      RowBox[{"term", "[", 
       RowBox[{"pld", ",", 
        RowBox[{"\[Sigma]s", "[", "1", "]"}], ",", "pr"}], "]"}]}], "]"}], 
    "-", 
    RowBox[{"NorOrder", "[", 
     RowBox[{
      RowBox[{"takeDag", "[", 
       RowBox[{"term", "[", 
        RowBox[{"pld", ",", 
         RowBox[{"\[Sigma]s", "[", "2", "]"}], ",", "pr"}], "]"}], "]"}], "**", 
      RowBox[{"term", "[", 
       RowBox[{"pld", ",", 
        RowBox[{"\[Sigma]s", "[", "2", "]"}], ",", "pr"}], "]"}]}], "]"}]}], 
   ")"}], "//", "represent"}]], "Input",
 CellChangeTimes->{{3.7618680572609606`*^9, 3.7618681009241223`*^9}, {
  3.761868273677949*^9, 3.7618682769003353`*^9}},
 CellLabel->
  "In[908]:=",ExpressionUUID->"557d0a0f-9a3a-4f15-baec-91419d8e3a59"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\[UpArrow]\\)\
\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.761868070699809*^9, 3.7618681019862823`*^9}, 
   3.7618681627832794`*^9, 3.7618682773172216`*^9},
 CellLabel->
  "Out[908]=",ExpressionUUID->"0721f9ff-daf2-4718-9714-f9794ede0880"]
}, Open  ]],

Cell[BoxData[{
 FormBox[
  RowBox[{
   SubsuperscriptBox["n", "3", "2"], "-", 
   SubsuperscriptBox["n", "4", "2"]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], 
        SuperscriptBox["\[Sigma]", "z"], 
        SubscriptBox["\[Psi]", "R"]}], ")"}], "\[Dagger]"], 
     SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], 
     SuperscriptBox["\[Sigma]", "z"], 
     SubscriptBox["\[Psi]", "R"]}], "-", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], "(", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SuperscriptBox["\[Sigma]", "0"]}], ")"}], 
        SubscriptBox["\[Psi]", "R"]}], ")"}], "\[Dagger]"], 
     RowBox[{
      SubsuperscriptBox["\[Psi]", "L", "\[Dagger]"], "(", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SuperscriptBox["\[Sigma]", "0"]}], ")"}], 
     SubscriptBox["\[Psi]", "R"]}]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], 
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       SubscriptBox["l", "34"], "\[Phi]"}]]}], "-", 
    RowBox[{"2", 
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"2", "\[Pi]"}], ")"}], "2"]], 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", 
       SubscriptBox["l", "34"], "\[Phi]"}]]}]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["4", 
       RowBox[{"4", 
        SuperscriptBox["\[Pi]", "2"]}]]}], "cos", " ", 
     SubscriptBox["l", "34"], "\[Phi]"}], "=", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SuperscriptBox["\[Pi]", "2"]]}], "cos", " ", 
     SubscriptBox["l", "34"], "\[Phi]"}]}]}], 
  TraditionalForm]}], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761867650463035*^9, 3.7618677446467037`*^9}, {
  3.7618679896353188`*^9, 3.761868049757018*^9}, {3.7618681703490562`*^9, 
  3.761868189519899*^9}, {3.7618682925355434`*^9, 3.761868312580897*^9}, {
  3.761868403454061*^9, 3.76186847031344*^9}, {3.7618685240368395`*^9, 
  3.7618685270567675`*^9}, {3.761868562856079*^9, 3.7618685899650784`*^9}, {
  3.761868629383108*^9, 3.7618686379529*^9}, {3.76186869882934*^9, 
  3.7618687051165457`*^9}},ExpressionUUID->"ce99cfdd-f403-4ee4-8a1b-\
0da3739ff65d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"NorOrder", "[", 
     RowBox[{
      RowBox[{"takeDag", "[", 
       RowBox[{"term", "[", 
        RowBox[{"pld", ",", 
         RowBox[{"\[Sigma]s", "[", "3", "]"}], ",", "pr"}], "]"}], "]"}], "**", 
      RowBox[{"term", "[", 
       RowBox[{"pld", ",", 
        RowBox[{"\[Sigma]s", "[", "3", "]"}], ",", "pr"}], "]"}]}], "]"}], 
    "-", 
    RowBox[{"NorOrder", "[", 
     RowBox[{
      RowBox[{"takeDag", "[", 
       RowBox[{"term", "[", 
        RowBox[{"pld", ",", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"\[Sigma]s", "[", "0", "]"}]}], ",", "pr"}], "]"}], "]"}], "**", 
      RowBox[{"term", "[", 
       RowBox[{"pld", ",", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"\[Sigma]s", "[", "0", "]"}]}], ",", "pr"}], "]"}]}], 
     "]"}]}], ")"}], "//", "represent"}]], "Input",
 CellChangeTimes->{{3.761868593099699*^9, 3.761868604507599*^9}},
 CellLabel->
  "In[909]:=",ExpressionUUID->"04b3a5ca-6e5a-44fa-af80-ec4ed08e15a0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[UpArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\[UpArrow]\\)\
\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.7618686052595887`*^9},
 CellLabel->
  "Out[909]=",ExpressionUUID->"ae58be62-73ef-4d88-ae64-27fd7f59ffbc"]
}, Open  ]],

Cell["Distortion", "TextIndent",
 CellChangeTimes->{{3.7618688157705727`*^9, 
  3.7618688194093275`*^9}},ExpressionUUID->"be5d3e11-f040-4629-bde6-\
d28f44ebac97"],

Cell[BoxData[{
 FormBox[
  RowBox[{
   RowBox[{
    SubsuperscriptBox["n", "1", "2"], "+", 
    SubsuperscriptBox["n", "2", "2"], "-", 
    SubsuperscriptBox["n", "3", "2"], "-", 
    SubsuperscriptBox["n", "4", "2"]}], "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"4", 
      SuperscriptBox["\[Pi]", "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{"L", "\[DownArrow]"}]]}], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{"R", "\[DownArrow]"}]]}]}], "+", 
      RowBox[{"2", 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{"L", "\[DownArrow]"}]]}], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{"R", "\[UpArrow]"}]]}]}], "+", 
      RowBox[{"2", 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{"L", "\[UpArrow]"}]]}], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{"R", "\[DownArrow]"}]]}]}], "-", 
      RowBox[{"2", 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{"L", "\[UpArrow]"}]]}], 
       RowBox[{
        SubscriptBox["\[PartialD]", "x"], 
        SubscriptBox["\[CurlyPhi]", 
         RowBox[{"R", "\[UpArrow]"}]]}]}]}], ")"}]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{"=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", 
      RowBox[{"2", 
       SuperscriptBox["\[Pi]", "2"]}]]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[UpArrow]"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[DownArrow]"}]]}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"R", "\[UpArrow]"}]]}], "-", 
      RowBox[{
       SubscriptBox["\[PartialD]", "x"], 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"R", "\[DownArrow]"}]]}]}], ")"}]}]}], 
  TraditionalForm]}], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.761868825853953*^9, 3.761868834552303*^9}, {
  3.761868865851743*^9, 
  3.7618690696934156`*^9}},ExpressionUUID->"5acd775b-5624-4000-9a79-\
d3be6ecdc1aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"NorOrder", "[", 
     RowBox[{
      RowBox[{"takeDag", "[", 
       RowBox[{"term", "[", 
        RowBox[{"pld", ",", 
         RowBox[{"\[Sigma]s", "[", "1", "]"}], ",", "pr"}], "]"}], "]"}], "**", 
      RowBox[{"term", "[", 
       RowBox[{"pld", ",", 
        RowBox[{"\[Sigma]s", "[", "1", "]"}], ",", "pr"}], "]"}]}], "]"}], 
    "+", 
    RowBox[{"NorOrder", "[", 
     RowBox[{
      RowBox[{"takeDag", "[", 
       RowBox[{"term", "[", 
        RowBox[{"pld", ",", 
         RowBox[{"\[Sigma]s", "[", "2", "]"}], ",", "pr"}], "]"}], "]"}], "**", 
      RowBox[{"term", "[", 
       RowBox[{"pld", ",", 
        RowBox[{"\[Sigma]s", "[", "2", "]"}], ",", "pr"}], "]"}]}], "]"}], 
    "-", 
    RowBox[{"NorOrder", "[", 
     RowBox[{
      RowBox[{"takeDag", "[", 
       RowBox[{"term", "[", 
        RowBox[{"pld", ",", 
         RowBox[{"\[Sigma]s", "[", "3", "]"}], ",", "pr"}], "]"}], "]"}], "**", 
      RowBox[{"term", "[", 
       RowBox[{"pld", ",", 
        RowBox[{"\[Sigma]s", "[", "3", "]"}], ",", "pr"}], "]"}]}], "]"}], 
    "-", 
    RowBox[{"NorOrder", "[", 
     RowBox[{
      RowBox[{"takeDag", "[", 
       RowBox[{"term", "[", 
        RowBox[{"pld", ",", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          RowBox[{"\[Sigma]s", "[", "0", "]"}]}], ",", "pr"}], "]"}], "]"}], "**", 
      RowBox[{"term", "[", 
       RowBox[{"pld", ",", 
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", 
         RowBox[{"\[Sigma]s", "[", "0", "]"}]}], ",", "pr"}], "]"}]}], 
     "]"}]}], ")"}], "//", "represent"}]], "Input",
 CellChangeTimes->{{3.7618688436679373`*^9, 3.761868857276664*^9}},
 CellLabel->
  "In[910]:=",ExpressionUUID->"806f376a-ea01-49f0-b699-07e7b11e08f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(L\\)\\(\[DownArrow]\\)\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\[UpArrow]\\)\
\\)]\\)\"\>"}], "]"}]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\[UpArrow]\\)\
\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[DownArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \
\\(\\(R\\)\\(\[DownArrow]\\)\\)]\\)\"\>"}], "]"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"NO", "[", 
    RowBox[{"\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(L\\)\\(\[UpArrow]\\)\
\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubsuperscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\
\[UpArrow]\\)\\), \\(\[Dagger]\\)]\\)\"\>", 
     ",", "\<\"\\!\\(\\*SubscriptBox[\\(\[Psi]\\), \\(\\(R\\)\\(\[UpArrow]\\)\
\\)]\\)\"\>"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.761868859489749*^9},
 CellLabel->
  "Out[910]=",ExpressionUUID->"5a10cafa-e287-40ce-aa07-c947160f56dc"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["D", "0"], "=", 
   RowBox[{
    SubscriptBox["\[PartialD]", "x"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["\[CurlyPhi]", 
        RowBox[{"L", "\[UpArrow]"}]]}], "-", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"L", "\[DownArrow]"}]], "-", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[UpArrow]"}]], "-", 
      SubscriptBox["\[CurlyPhi]", 
       RowBox[{"R", "\[DownArrow]"}]]}], ")"}]}]}], 
  TraditionalForm]], "DisplayFormulaNumbered",
 CellChangeTimes->{
  3.7618688906927996`*^9},ExpressionUUID->"c92059aa-269b-4145-bfda-\
47a6fc2b955a"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jordan - Wigner transformation", "Section",
 CellChangeTimes->{{3.762261458472599*^9, 
  3.7622614688239326`*^9}},ExpressionUUID->"cc6022bb-07de-4913-9ff1-\
633511dc248d"],

Cell[TextData[{
 "Quantum spins are notoriously difficult objects to deal with in many - body \
physics, because they do not behave as canonical fermions or bosons. In one \
dimension, however, it turns out that spins with ",
 Cell[BoxData[
  FormBox[
   RowBox[{"S", "=", 
    RowBox[{"1", "/", "2"}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "55370545-10c6-4f14-8f80-3c2190e298db"],
 " actually behave like fermions. Let\[CloseCurlyQuote]s introduce,"
}], "TextIndent",
 CellChangeTimes->{{3.7622618953370523`*^9, 3.762261945193836*^9}, {
  3.7622622613019896`*^9, 
  3.762262281416235*^9}},ExpressionUUID->"493a3738-52d0-4ad9-a423-\
6f7fc4734396"],

Cell[BoxData[{
 FormBox[
  RowBox[{
   SubsuperscriptBox["S", "j", "z"], "=", 
   RowBox[{
    RowBox[{
     SubsuperscriptBox["f", "j", "\[Dagger]"], 
     SubscriptBox["f", "j"]}], "-", 
    FractionBox["1", "2"]}]}], TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{
   SubsuperscriptBox["S", "j", "+"], "=", 
   RowBox[{
    SubsuperscriptBox["f", "j", "\[Dagger]"], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"\[ImaginaryI]", " ", "\[Pi]", 
      RowBox[{
       SubscriptBox["\[Sum]", 
        RowBox[{"l", "<", "j"}]], 
       SubscriptBox["n", "l"]}]}]]}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{
   SubsuperscriptBox["S", "j", "-"], "=", 
   RowBox[{
    SubscriptBox["f", "j"], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Pi]", 
      RowBox[{
       SubscriptBox["\[Sum]", 
        RowBox[{"l", "<", "j"}]], 
       SubscriptBox["n", "l"]}]}]]}]}], 
  TraditionalForm]}], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7622622845468683`*^9, 3.762262311077989*^9}, {
  3.762262416654842*^9, 
  3.762262446139044*^9}},ExpressionUUID->"e2de6e78-bff2-4cf4-bdfd-\
a9f05900e404"],

Cell[TextData[{
 "and introduce ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Phi]", "j"], "=", 
    RowBox[{"\[Pi]", " ", 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       RowBox[{"l", "<", "j"}]], 
      SubscriptBox["n", "l"]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1b57efb8-dafd-42bb-a6ad-dac33c7a725b"],
 "useful commutation relations,"
}], "TextIndent",
 CellChangeTimes->{{3.7622626940554347`*^9, 3.762262705347288*^9}, {
  3.762262821031068*^9, 
  3.7622628454078856`*^9}},ExpressionUUID->"a8d340b2-0890-4e48-8c65-\
c629247a34a3"],

Cell[BoxData[{
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["\[Phi]", "j"]}]], ",", 
      SubsuperscriptBox["f", "l", 
       RowBox[{"(", "\[Dagger]", ")"}]]}], "}"}], "=", "0"}], ",", " ", 
   RowBox[{
    RowBox[{"for", " ", "l"}], "<", "j"}]}], 
  TraditionalForm], "\[IndentingNewLine]", 
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox["\[Phi]", "j"]}]], ",", 
      SubsuperscriptBox["f", "l", 
       RowBox[{"(", "\[Dagger]", ")"}]]}], "]"}], "=", "0"}], ",", " ", 
   RowBox[{
    RowBox[{"for", " ", "l"}], "\[GreaterEqual]", " ", "j"}]}], 
  TraditionalForm], "\[IndentingNewLine]"
 FormBox[, TraditionalForm]}], "DisplayFormulaNumbered",
 CellChangeTimes->{{3.7622627219558153`*^9, 3.76226274632972*^9}, {
  3.7622628577598715`*^9, 
  3.7622629467071967`*^9}},ExpressionUUID->"0d5ce715-dadb-451d-8dc0-\
2b2c5b486692"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 637},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (2017\:5e749\:670810\
\:65e5)",
StyleDefinitions->"Cambria Article.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 152, 3, 99, "Title",ExpressionUUID->"4d2185bc-faaa-4204-ab86-f554734b7f71"],
Cell[CellGroupData[{
Cell[757, 29, 162, 3, 87, "Section",ExpressionUUID->"59a9c5ca-74cb-4e9b-834c-e32382df7efe"],
Cell[922, 34, 8021, 208, 1011, "Code",ExpressionUUID->"1b4ea778-2970-4358-8c7a-8470b43cd4ba"],
Cell[CellGroupData[{
Cell[8968, 246, 1613, 39, 146, "Input",ExpressionUUID->"80b4dc44-aece-4634-bc1a-77332b91ad0e"],
Cell[10584, 287, 853, 20, 41, "Output",ExpressionUUID->"655813e4-6ec1-4aa4-837f-211b205ba79b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11486, 313, 159, 3, 87, "Section",ExpressionUUID->"46c92ddd-283e-4af5-9636-81cae3bd739d"],
Cell[11648, 318, 256, 4, 30, "TextIndent",ExpressionUUID->"cde0b0b7-e5e6-4188-ae16-8effab749546"],
Cell[11907, 324, 701, 23, 59, "DisplayFormulaNumbered",ExpressionUUID->"d2d0e69f-576b-4840-97bc-04829065b1f0"],
Cell[12611, 349, 8644, 224, 788, "Code",ExpressionUUID->"2867befe-40c7-4f90-ad3e-00619658b556"],
Cell[21258, 575, 3752, 79, 185, "Code",ExpressionUUID->"b7847fdc-37a9-4f8c-940b-0be2d0ff53ca"],
Cell[CellGroupData[{
Cell[25035, 658, 2215, 60, 222, "Code",ExpressionUUID->"5d326349-2b13-4deb-aabe-052414fa5bc0"],
Cell[27253, 720, 1504, 34, 41, "Output",ExpressionUUID->"485ed483-2f06-4aa7-be77-7fee3f5e7c87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28794, 759, 156, 3, 50, "Subsection",ExpressionUUID->"f7b2c999-e38d-4596-b6f1-507f4a34f6db"],
Cell[CellGroupData[{
Cell[28975, 766, 166, 3, 92, "Subsubsubsection",ExpressionUUID->"17234603-0d55-40be-97e5-63d45a8e73dd"],
Cell[CellGroupData[{
Cell[29166, 773, 1309, 35, 160, "Input",ExpressionUUID->"1506ac57-e1d4-4882-8f09-509b6bd2ccb2"],
Cell[30478, 810, 687, 15, 103, "Output",ExpressionUUID->"40d77aa9-6974-4184-8f03-cfbf0c8cc7df"]
}, Open  ]],
Cell[31180, 828, 1524, 46, 154, "DisplayFormulaNumbered",ExpressionUUID->"7e1e3212-bfbd-44d7-a26e-3ab01ba9d6a1"],
Cell[CellGroupData[{
Cell[32729, 878, 752, 20, 162, "Input",ExpressionUUID->"66f7312a-d01a-4f96-b14f-46d2a9d7ccf2"],
Cell[33484, 900, 2036, 41, 103, "Output",ExpressionUUID->"09e5630d-a349-482f-b5cf-b7ec57977eaf"]
}, Open  ]],
Cell[35535, 944, 980, 32, 154, "DisplayFormulaNumbered",ExpressionUUID->"b060b79d-9c04-44a5-a6a3-5bb9e1aa65e4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36552, 981, 172, 3, 92, "Subsubsubsection",ExpressionUUID->"97ba837e-a486-471b-9f01-f65ee6af1272"],
Cell[36727, 986, 1115, 31, 105, "DisplayFormulaNumbered",ExpressionUUID->"13cad89f-53ba-48bf-bf55-4a9d92d75bb9"],
Cell[CellGroupData[{
Cell[37867, 1021, 519, 14, 94, "Input",ExpressionUUID->"9b493979-38a6-4a89-ba41-2f87fe663a8c"],
Cell[38389, 1037, 1194, 25, 103, "Output",ExpressionUUID->"90d9c125-a641-49b4-a85f-1bb170192107"]
}, Open  ]],
Cell[39598, 1065, 815, 23, 100, "DisplayFormulaNumbered",ExpressionUUID->"313bbdb3-87cc-4ecd-b5fa-e3aa7c6924dd"],
Cell[CellGroupData[{
Cell[40438, 1092, 493, 13, 94, "Input",ExpressionUUID->"e8942255-ca15-488e-8453-487822c7b029"],
Cell[40934, 1107, 1301, 28, 103, "Output",ExpressionUUID->"beb8700d-d28a-4036-a0d1-3c880cc24079"]
}, Open  ]],
Cell[42250, 1138, 683, 20, 100, "DisplayFormulaNumbered",ExpressionUUID->"2e9fe1a2-ffa4-4f16-ac06-36285bd116e9"],
Cell[CellGroupData[{
Cell[42958, 1162, 495, 13, 94, "Input",ExpressionUUID->"13dac4dd-eae9-41df-a1ec-cc04d1e7ca14"],
Cell[43456, 1177, 1147, 24, 103, "Output",ExpressionUUID->"19af8027-7748-4cc9-8851-7edd5d894143"]
}, Open  ]],
Cell[44618, 1204, 830, 24, 94, "DisplayFormulaNumbered",ExpressionUUID->"bb4fa2c9-495e-445a-aaba-40eedcce4b9f"],
Cell[CellGroupData[{
Cell[45473, 1232, 596, 16, 94, "Input",ExpressionUUID->"d75a311d-fbe2-4541-8089-808f301335c5"],
Cell[46072, 1250, 1344, 29, 103, "Output",ExpressionUUID->"07a38cc2-6511-4019-8637-c23f93606597"]
}, Open  ]],
Cell[47431, 1282, 849, 24, 94, "DisplayFormulaNumbered",ExpressionUUID->"7014eddf-42c0-4303-b3e2-9b96edc4851d"],
Cell[CellGroupData[{
Cell[48305, 1310, 596, 16, 94, "Input",ExpressionUUID->"e5456f8c-4a30-4fd5-987e-7c88a49ae99f"],
Cell[48904, 1328, 1299, 28, 103, "Output",ExpressionUUID->"9be71d81-c964-4586-adc9-9d1658061864"]
}, Open  ]],
Cell[50218, 1359, 1169, 32, 105, "DisplayFormulaNumbered",ExpressionUUID->"883d9f48-146b-4ed0-bfbe-703b658ca51d"],
Cell[CellGroupData[{
Cell[51412, 1395, 542, 14, 94, "Input",ExpressionUUID->"07ea6011-85ce-493f-9a8d-eeb8c5000e76"],
Cell[51957, 1411, 1220, 26, 103, "Output",ExpressionUUID->"ecdd3b3f-8531-444e-af92-3dcddef41ca1"]
}, Open  ]],
Cell[53192, 1440, 762, 22, 100, "DisplayFormulaNumbered",ExpressionUUID->"e8a482ec-8010-47c0-b092-f5ac54a95cdd"],
Cell[CellGroupData[{
Cell[53979, 1466, 495, 13, 94, "Input",ExpressionUUID->"337a64e9-a4c0-4369-8c51-a5580064443c"],
Cell[54477, 1481, 1320, 29, 103, "Output",ExpressionUUID->"dd0188d0-0592-4d5c-a4e0-0ae554788261"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55846, 1516, 175, 3, 92, "Subsubsubsection",ExpressionUUID->"f909ef5a-6b30-4d5f-925d-24f17b770b4a"],
Cell[56024, 1521, 1322, 39, 105, "DisplayFormulaNumbered",ExpressionUUID->"2c6ce828-0d0b-4c1f-bcb2-7f829c9af3f9"],
Cell[CellGroupData[{
Cell[57371, 1564, 494, 13, 94, "Input",ExpressionUUID->"a6f1d4b2-6257-423c-9f40-aecb484f2d9e"],
Cell[57868, 1579, 1168, 25, 103, "Output",ExpressionUUID->"86c71157-03c8-4210-885d-3a9e847e7439"]
}, Open  ]],
Cell[59051, 1607, 1330, 39, 178, "DisplayFormulaNumbered",ExpressionUUID->"bbe9e60a-de73-45f2-b86a-2be5317d36e4"],
Cell[CellGroupData[{
Cell[60406, 1650, 528, 14, 162, "Input",ExpressionUUID->"f908bc3b-165c-4747-a3f7-e05839a70891"],
Cell[60937, 1666, 1196, 25, 176, "Output",ExpressionUUID->"bdb8b936-46fb-412d-b2b4-7901b4947744"]
}, Open  ]],
Cell[62148, 1694, 722, 21, 178, "DisplayFormulaNumbered",ExpressionUUID->"96957052-0bd2-4d84-b09e-810c587c705f"],
Cell[CellGroupData[{
Cell[62895, 1719, 520, 14, 162, "Input",ExpressionUUID->"59ea75d2-98d9-4c1e-ba3c-5511354f88b6"],
Cell[63418, 1735, 1170, 25, 176, "Output",ExpressionUUID->"36231565-f60c-42d4-8101-b4664e980553"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64637, 1766, 168, 3, 160, "Subsubsubsection",ExpressionUUID->"9312042d-1f1e-4910-b659-090abf57c8db"],
Cell[64808, 1771, 2413, 72, 776, "DisplayFormulaNumbered",ExpressionUUID->"c7c3340d-6c51-4174-9ae7-85251fc45b92"],
Cell[CellGroupData[{
Cell[67246, 1847, 1000, 27, 270, "Input",ExpressionUUID->"e06eda45-a581-4775-968b-9765d4b21821"],
Cell[68249, 1876, 1224, 26, 176, "Output",ExpressionUUID->"8df70aea-457a-4fdf-95ee-7545c1b9e7f2"]
}, Open  ]],
Cell[69488, 1905, 2751, 80, 776, "DisplayFormulaNumbered",ExpressionUUID->"4ac388e0-bc78-4b71-b474-f7ee5a99867b"],
Cell[CellGroupData[{
Cell[72264, 1989, 1083, 30, 270, "Input",ExpressionUUID->"a3371c33-09cf-4d30-bc9b-1ec9d3ac0a67"],
Cell[73350, 2021, 1148, 25, 176, "Output",ExpressionUUID->"f11276c6-1f96-42c3-8418-7e1e05a1716a"]
}, Open  ]],
Cell[74513, 2049, 162, 3, 136, "TextIndent",ExpressionUUID->"72659e90-64ad-4a5b-b29f-7ac4d4d1d1b4"],
Cell[74678, 2054, 2648, 83, 496, "DisplayFormulaNumbered",ExpressionUUID->"f1576fc4-abf4-4669-bf48-ce49abf04256"],
Cell[CellGroupData[{
Cell[77351, 2141, 1797, 50, 478, "Input",ExpressionUUID->"9bd8577a-23e1-4377-affd-9de5263b16e3"],
Cell[79151, 2193, 2099, 44, 176, "Output",ExpressionUUID->"7b499abe-ddaf-4286-9d2d-4aee74c266f6"]
}, Open  ]],
Cell[81265, 2240, 649, 20, 178, "DisplayFormulaNumbered",ExpressionUUID->"c92059aa-269b-4145-bfda-47a6fc2b955a"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81975, 2267, 177, 3, 87, "Section",ExpressionUUID->"cc6022bb-07de-4913-9ff1-633511dc248d"],
Cell[82155, 2272, 681, 15, 54, "TextIndent",ExpressionUUID->"493a3738-52d0-4ad9-a423-6f7fc4734396"],
Cell[82839, 2289, 1192, 37, 127, "DisplayFormulaNumbered",ExpressionUUID->"e2de6e78-bff2-4cf4-bdfd-a9f05900e404"],
Cell[84034, 2328, 595, 18, 35, "TextIndent",ExpressionUUID->"a8d340b2-0890-4e48-8c65-c629247a34a3"],
Cell[84632, 2348, 1068, 31, 103, "DisplayFormulaNumbered",ExpressionUUID->"0d5ce715-dadb-451d-8dc0-2b2c5b486692"]
}, Open  ]]
}, Open  ]]
}
]
*)

